<mat-card id="testcard">
  <form fxLayout="column" fxLayoutAlign="center center" [formGroup]="leasingForm" (ngSubmit)="submitForm()">

    <mat-form-field>
      <mat-select placeholder="{{leasingFormLabels.CUSTOMER_TYPE}}" class="form-control" id="customerType"
                  name="customerTypeField"
                  formControlName="customerType" (change)="updateMinValues()">
        <mat-option [value]="PRIVATE">Private</mat-option>
        <mat-option [value]="BUSINESS">Business</mat-option>
      </mat-select>
      <mat-error *ngIf="leasingForm.get('customerType').valid || leasingForm.get('customerType').untouched">
        Customer Type is required
      </mat-error>
    </mat-form-field>

    <mat-form-field>
      <mat-select placeholder="{{leasingFormLabels.ASSET_TYPE}}" class="form-control" id="assetType"
                  name="assetTypeField">
        <mat-option *ngFor="let type of availableAssetTypes" [value]="type">{{type}}</mat-option>
        <mat-error *ngIf="leasingForm.get('assetType').valid || leasingForm.get('assetType').untouched">
          Customer type is required
        </mat-error>
      </mat-select>
    </mat-form-field>

    <mat-form-field>
      <input class="form-control" type="text" placeholder="{{leasingFormLabels.CAR_BRAND}}"
             matInput #input required
             formControlName="carBrand" [matAutocomplete]="auto"
             aria-label="carBrand"
             (change)="selectBrandHandler()"
             (keyup)="selectBrandHandler()"
      >
      <mat-error *ngIf="leasingForm.get('carBrand').invalid">{{getErrorMessage(leasingForm.get('carBrand'))}}
      </mat-error>
      <mat-autocomplete #auto="matAutocomplete">
        <mat-option *ngFor="let option of filteredOptions | async" [value]="option"
                    (click)="selectBrandHandler()">
          <img src="./assets/images/CarLogos/{{option}}.png" id="smallCarLogo"/>
          {{ option }}
        </mat-option>
      </mat-autocomplete>
    </mat-form-field>

    <mat-form-field>
      <mat-select placeholder="{{leasingFormLabels.CAR_MODEL}}" class="form-control" id="carModel"
                  name="carModelField"
                  formControlName="carModel">
        <mat-option *ngFor="let selectedModel of model" [value]="selectedModel">{{selectedModel}}</mat-option>
      </mat-select>
      <mat-error *ngIf="leasingForm.get('carModel').valid || leasingForm.get('carModel').untouched">
        Car Model is required
      </mat-error>
    </mat-form-field>

    <mat-form-field>
      <input type="date" matInput placeholder="{{leasingFormLabels.MANUFACTURED_DATE}}" class="form-control"
             id="manufacturedDate"
             formControlName="manufacturedDate"
             name="manufacturedDateForm">
      <mat-error *ngIf="leasingForm.get('manufacturedDate').valid || leasingForm.get('manufacturedDate').untouched">
        Manufactured date is required.
      </mat-error>
    </mat-form-field>

    <mat-form-field>
      <input type="number" matInput placeholder="{{leasingFormLabels.ENGINE_POWER}}" class="form-control"
             id="enginePower"
             formControlName="enginePower"
             name="enginePowerForm" min="1" max="9999">
      <mat-error *ngIf="leasingForm.get('enginePower').valid || leasingForm.get('enginePower').untouched">
        Engine power must be between 1 and 9999
      </mat-error>
    </mat-form-field>

    <mat-form-field>
      <input type="number" matInput placeholder="{{leasingFormLabels.ASSET_PRICE}}" class="form-control"
             id="assetPrice" required
             formControlName="assetPrice"
             name="assetPriceField"
             min="5000" max="9999999"
             (keyup)="manageDependantFields()"
             (change)="manageDependantFields()">
      <mat-error *ngIf="leasingForm.get('assetPrice').valid || leasingForm.get('assetPrice').untouched">
        Asset price must be between {{this.minAssetPrice}} and 9999999
      </mat-error>
    </mat-form-field>

    <mat-form-field>
      <input type="number" matInput placeholder="{{leasingFormLabels.ADVANCE_PAYMENT_PERCENTAGE}}"
             class="form-control" id="advancePaymentPercentage"
             formControlName="advancePaymentPercentage"
             name="advancePaymentPercentageField"
             min="10" max="100"
             (keyup)="calcAdvancePaymentAmount()"
             (change)="calcAdvancePaymentAmount()">
      <mat-error
        *ngIf="leasingForm.get('advancePaymentPercentage').valid || leasingForm.get('advancePaymentPercentage').untouched">
        Advance payment percentage must be between 10% and 100%
      </mat-error>
    </mat-form-field>

    <mat-form-field>
      <input type="text" matInput placeholder="{{leasingFormLabels.ADVANCE_PAYMENT_AMOUNT}}" class="form-control"
             id="advancePaymentAmount" name="advancePaymentAmountField"
             formControlName="advancePaymentAmount"
             min="500" max="9999999"
             (keyup)="calcAdvancePaymentPercentage()"
             (change)="calcAdvancePaymentPercentage()">
      <mat-error
       *ngIf="leasingForm.get('advancePaymentAmount').valid || leasingForm.get('advancePaymentAmount').untouched">
        Advance payment amount must be {{this.minAdvancePaymentAmount.toFixed(2)}}€ and
        {{this.maxAdvancePaymentAmount.toFixed(2)}}€
      </mat-error>
    </mat-form-field>

    <mat-form-field>
      <input type="text" matInput placeholder="{{leasingFormLabels.CONTRACT_FEE}}" class="form-control"
             id="contractFee" name="contractFeeField"
             formControlName="contractFee" disabled>
    </mat-form-field>

    <mat-form-field>
      <input type="number" matInput placeholder="{{leasingFormLabels.MARGIN}}"
             class="form-control" id="margin" required
             formControlName="margin" name="margin" step="0.1" min="3.2" max="100">
      <mat-error *ngIf="leasingForm.get('margin').valid || leasingForm.get('margin').untouched">
        Margin must be between 3.2% and 100 %
      </mat-error>
    </mat-form-field>

    <mat-form-field>
      <mat-select placeholder="{{leasingFormLabels.LEASING_PERIOD}}" class="form-control" id="leasePeriodInMonths"
                  required name="leasePeriodInMonthsField"
                  formControlName="leasePeriodInMonths">
        <mat-option *ngFor="let type of leasePeriods" [value]="type">{{type}}</mat-option>
      </mat-select>
      <mat-error
        *ngIf="leasingForm.get('leasePeriodInMonths').valid || leasingForm.get('leasePeriodInMonths').untouched"
        class="alert alert-danger">
        Lease period is required.
      </mat-error>
    </mat-form-field>

    <mat-form-field>
      <mat-select placeholder="{{leasingFormLabels.PAYMENT_DAY}}" class="form-control" id="paymentDay"
                  name="paymentDateField" formControlName="paymentDate"
                  required>
        <mat-option *ngFor="let currentDay of availableDays" [value]="currentDay">{{currentDay}}</mat-option>
      </mat-select>
      <mat-error *ngIf="leasingForm.get('paymentDate').valid || leasingForm.get('paymentDate').untouched"
                 class="alert alert-danger">
        Payment date is required.
      </mat-error>
    </mat-form-field>

    <button type="button" class="btn btn-group btn-outline-secondary" (click)="goBack()">Back</button>
    <button type="submit" class="btn btn-group btn-outline-primary" (click)="setLeasingModel()">
      Submit
      form
    </button>
  </form>
</mat-card>
