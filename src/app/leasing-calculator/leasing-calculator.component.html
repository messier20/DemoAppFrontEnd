<div class="card-container background ">
  <mat-card id="inputFormCard">

    <mat-card-header>
      <mat-card-title><h2 class="text-color ">Leasing Calculator</h2></mat-card-title>
    </mat-card-header>
    <mat-card-content id="inputCardContent">
      <form [formGroup]="leasingCalculatorForm" (ngSubmit)="submitForm()" class="forform">
        <mat-form-field class="inline-form">
          <mat-select id="customerType" required name="customerTypeField" placeholder="Customer type"
                      formControlName="customerType" (change)="updateMinValues()">

            <mat-option [value]="PRIVATE">Private</mat-option>
            <mat-option [value]="BUSINESS">Business</mat-option>
          </mat-select>
          <mat-error *ngIf="leasingCalculatorForm.get('customerType').invalid">
            Customer Type is <strong>required</strong>
          </mat-error>
        </mat-form-field>


        <div>
          <!--<label>{{leasingFormLabels.ASSET_PRICE}}</label>-->
          <mat-form-field>
            <input matInput #input type="number" class="form-control" id="assetPrice" required
                   formControlName="assetPrice" placeholder='{{leasingFormLabels.ASSET_PRICE}}'
                   name="assetPriceField"
                   min="5000" max="9999999"
                   [errorStateMatcher]="leasingCalculatorErrorMatcher"
                   (keyup)="manageDependantFields()"
                   (change)="manageDependantFields()">

            <mat-error *ngIf="leasingCalculatorForm.get('assetPrice').hasError('min')
        && !leasingCalculatorForm.get('assetPrice').hasError('required')
        && !leasingCalculatorForm.get('assetPrice').hasError('max')">
              Asset Price must be above <strong>{{this.minAssetPrice}}€</strong>
            </mat-error>
            <mat-error *ngIf="!leasingCalculatorForm.get('assetPrice').hasError('required')
        && leasingCalculatorForm.get('assetPrice').hasError('max')">
              Asset Price must be below <strong>{{validationAmounts.MAX_ASSET_PRICE}}€</strong>
            </mat-error>
            <mat-error *ngIf="leasingCalculatorForm.get('assetPrice').hasError('required')">
              Asset Price is <strong>required</strong>
            </mat-error>
            <!--<mat-error-->
            <!--*ngIf="leasingCalculatorForm.get('assetPrice').valid || leasingCalculatorForm.get('assetPrice').untouched"-->
            <!--class="alert alert-danger">-->
            <!--Asset price must be between {{this.minAssetPrice.toFixed(2)}}€ and 9999999.00€-->
            <!--</mat-error>-->
          </mat-form-field>
        </div>


        <!--</div>-->

        <div>
          <!--<label> {{leasingFormLabels.ADVANCE_PAYMENT_PERCENTAGE}} </label>-->
          <mat-form-field>
            <input matInput #input type="number" class="form-control" id="advancePaymentPercentage"
                   formControlName="advancePaymentPercentage" placeholder="Advance payment percentage"
                   name="advancePaymentPercentageField"
                   min="10" max="100"
                   (keyup)="calcAdvancePaymentAmount()"
                   (change)="calcAdvancePaymentAmount()"
                   [errorStateMatcher]="leasingCalculatorErrorMatcher">
            <mat-error *ngIf="leasingCalculatorForm.get('advancePaymentPercentage').hasError('min')
        && !leasingCalculatorForm.get('advancePaymentPercentage').hasError('required')
        && !leasingCalculatorForm.get('advancePaymentPercentage').hasError('max')">
              Advance payment percentage must be above
              <strong>{{validationAmounts.ADVANCE_PAYMENT_PERCENTAGE_MIN}}%</strong>
            </mat-error>
            <mat-error *ngIf="!leasingCalculatorForm.get('advancePaymentPercentage').hasError('required')
        && leasingCalculatorForm.get('advancePaymentPercentage').hasError('max')">
              Advance payment percentage must be below
              <strong>{{validationAmounts.ADVANCE_PAYMENT_PERCENTAGE_MAX}}%</strong>
            </mat-error>
            <mat-error *ngIf="leasingCalculatorForm.get('advancePaymentPercentage').hasError('required')">
              Advance payment percentage is <strong>required</strong>
            </mat-error>
          </mat-form-field>
        </div>


        <!--</div>-->

        <div class="form-row">
          <mat-form-field>
            <input matInput #input type="number" class="form-control" id="advancePaymentAmount"
                   placeholder="Advance payment amount"
                   name="advancePaymentAmountField"
                   formControlName="advancePaymentAmount"
                   min="500" max="9999999"
                   (keyup)="calcAdvancePaymentPercentage()"
                   (change)="calcAdvancePaymentPercentage()"
                   [errorStateMatcher]="leasingCalculatorErrorMatcher">
            <mat-error *ngIf="leasingCalculatorForm.get('advancePaymentAmount').hasError('min')
        && !leasingCalculatorForm.get('advancePaymentAmount').hasError('required')
        && !leasingCalculatorForm.get('advancePaymentAmount').hasError('max')">
              Advance payment amount must be above
              <strong>{{this.minAdvancePaymentAmount.toFixed(2)}}€</strong>
            </mat-error>
            <mat-error *ngIf="!leasingCalculatorForm.get('advancePaymentAmount').hasError('required')
        && leasingCalculatorForm.get('advancePaymentAmount').hasError('max')">
              Advance payment amount must be below
              <strong>{{this.maxAdvancePaymentAmount.toFixed(2)}}€</strong>
            </mat-error>
            <mat-error *ngIf="leasingCalculatorForm.get('advancePaymentAmount').hasError('required')">
              Advance payment amount is <strong>required</strong>
            </mat-error>
          </mat-form-field>
        </div>


        <!--</div>-->

        <div>
          <!--<label for="contractFee">{{leasingFormLabels.CONTRACT_FEE}}</label>-->
          <mat-form-field>
            <input matInput #input type="text" class="form-control" id="contractFee" name="contractFeeField"
                   formControlName="contractFee"
                   placeholder="Contract fee" disabled>
          </mat-form-field>
        </div>


        <div>
          <!--<label for="margin">{{leasingFormLabels.MARGIN}}</label>-->
          <mat-form-field>
            <input matInput #input type="number" class="form-control" placeholder="Margin" id="margin" required
                   formControlName="margin" name="margin" step="0.1" min="3.2" max="100"
                   [errorStateMatcher]="leasingCalculatorErrorMatcher">
            <mat-error *ngIf="leasingCalculatorForm.get('margin').hasError('min')
        && !leasingCalculatorForm.get('margin').hasError('required')
        && !leasingCalculatorForm.get('margin').hasError('max')">
              Margin must be above
              <strong>{{validationAmounts.MARGIN_MIN}}%</strong>
            </mat-error>
            <mat-error *ngIf="!leasingCalculatorForm.get('margin').hasError('required')
        && leasingCalculatorForm.get('margin').hasError('max')">
              Margin payment amount must be below
              <strong>{{validationAmounts.MARGIN_MAX}}%</strong>
            </mat-error>
            <mat-error *ngIf="leasingCalculatorForm.get('margin').hasError('required')">
              Margin payment amount is <strong>required</strong>
            </mat-error>
          </mat-form-field>
        </div>


        <!--</div>-->

        <div>
          <!--<label>{{leasingFormLabels.LEASING_PERIOD}}</label>-->
          <mat-form-field>
            <mat-select formControlName="leasePeriodInMonths" placeholder="Leasing period">
              <mat-option *ngFor="let type of leasePeriods" required [value]="type">{{type}}</mat-option>
            </mat-select>
            <mat-error *ngIf="leasingCalculatorForm.get('leasePeriodInMonths').invalid">
              Lease Period is <strong>required</strong>
            </mat-error>
          </mat-form-field>
        </div>


        <div>
          <!--<label>{{leasingFormLabels.PAYMENT_DAY}}</label>-->
          <mat-form-field>
            <mat-select formControlName="paymentDate" placeholder="Payment day">
              <mat-option *ngFor="let currentDay of availableDays" required [value]="currentDay"> {{currentDay}}
              </mat-option>
            </mat-select>
            <mat-error *ngIf="leasingCalculatorForm.get('paymentDate').invalid">
              Payment Date is <strong>required</strong>
            </mat-error>
          </mat-form-field>
        </div>

        <button mat-raised-button type="submit" class="button-calculate" (click)="isVisible()">Calculate</button>
        <button mat-raised-button type="button" color="accent" (click)="setLeasingCalculator()">Apply Now</button>

      </form>
    </mat-card-content>
    <mat-card-actions>
      <!--<button mat-button>LIKE</button>-->
      <!--<button mat-button>SHARE</button>-->
      <!--<button type="submit" class="btn btn-success" (click)="isVisible()">Calculate</button>-->
      <!--<button type="button" class="btn btn-success" (click)="setLeasingCalculator()">Apply Now</button>-->
    </mat-card-actions>
  </mat-card>
  <mat-card class="background" id="matcard2">
    <mat-card-header>
      <mat-card-title>Leasing Payment Schedule</mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <div id="repaymentSchedule" hidden>
        <form>
          <div class="form-row my-style">
            <div class="form-group col-sm-2" *ngFor="let label of leasingCalculatorLabels">
              <div class="panel panel-info">
                <div class="panel-body"><b>{{label}}</b>
                </div>
              </div>
            </div>
          </div>
          <div class="form-row" *ngFor="let repayment of repaymentSchedule">
            <div class="form-group col-sm-2">
              <div class="panel panel-info">
                <div class="panel-body">
                  <i>{{repayment.repaymentDate}}</i>
                </div>
              </div>
            </div>
            <div class="form-group col-sm-2">
              <div class="panel panel-info">
                <div class="panel-body">
                  <i>{{repayment.remainingAmountToRepay.toFixed(2)}}</i>
                </div>
              </div>
            </div>
            <div class="form-group col-sm-2">
              <div class="panel panel-info">
                <div class="panel-body">
                  <i>{{repayment.assetValuePaymentAmount.toFixed(2)}}</i>
                </div>
              </div>
            </div>
            <div class="form-group col-sm-2">
              <div class="panel panel-info">
                <div class="panel-body">
                  <i>{{repayment.interestPaymentAmount.toFixed(2)}}</i>
                </div>
              </div>
            </div>
            <!--<div class="form-group col-sm-2">-->
            <!--<div class="panel panel-info">-->
            <!--<div class="panel-body" *ngIf="repayment.contractFee != 0">-->
            <!--<i>{{repayment.contractFee.toFixed(2)}}</i>-->
            <!--</div>-->
            <!--</div>-->
            <!--</div>-->
            <div class="form-group col-sm-2">
              <div class="panel panel-info">
                <div class="panel-body">
                  <i>{{repayment.totalPaymentAmount.toFixed(2)}}</i>
                </div>
              </div>
            </div>
          </div>
        </form>
      </div>
    </mat-card-content>

  </mat-card>
</div>
